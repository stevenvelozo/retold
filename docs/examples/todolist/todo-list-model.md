# Todo List: System Model

> Part of the [Todo List Application](examples/todolist/todo-list.md) example.
>
> **Source:** [`examples/todo-list/model/`](../examples/todo-list/model/)

The Task entity is defined once and consumed by every component in the application. This is a core Retold pattern: the data model is the source of truth, and everything else -- table creation, API endpoints, query generation -- flows from it.

## Stricture MicroDDL

The schema starts as a `.mddl` file -- Stricture's one-line-per-field notation:

```
!Task
@IDTask
%GUIDTask
$Name 200
*Description
&DueDate
.LengthInHours 10,2
$Status 32
&CreateDate
#CreatingIDUser -> IDUser
&UpdateDate
#UpdatingIDUser -> IDUser
^Deleted
&DeleteDate
#DeletingIDUser -> IDUser
```

Each sigil declares the column type:

| Sigil | Meaning | Example |
|-------|---------|---------|
| `!` | Entity (table) name | `!Task` |
| `@` | Auto-increment identity | `@IDTask` |
| `%` | Auto-generated GUID | `%GUIDTask` |
| `$` | String with max length | `$Name 200` |
| `*` | Text (unlimited length) | `*Description` |
| `&` | DateTime | `&DueDate` |
| `.` | Decimal (precision, scale) | `.LengthInHours 10,2` |
| `#` | Integer (foreign key) | `#CreatingIDUser -> IDUser` |
| `^` | Boolean flag | `^Deleted` |

The audit columns (CreateDate, CreatingIDUser, UpdateDate, UpdatingIDUser, Deleted, DeleteDate, DeletingIDUser) follow the standard Meadow audit trail convention. Meadow manages these automatically -- you never set them in application code.

## Compiled DDL

Running the Stricture compiler produces `Task-Compiled.json`, a JSON representation of the table structure that the SQLite provider uses to generate CREATE TABLE statements at startup:

```json
{
  "Tables": [
    {
      "TableName": "Task",
      "Columns": [
        { "Column": "IDTask", "DataType": "AutoIdentity" },
        { "Column": "GUIDTask", "DataType": "AutoGUID" },
        { "Column": "Name", "DataType": "String", "Size": "200" },
        ...
      ]
    }
  ]
}
```

The server passes this to `meadow-connection-sqlite`'s `createTables()` method, which generates and executes the appropriate SQLite DDL. You never write CREATE TABLE statements by hand.

## Meadow Schema

`MeadowSchema-Task.json` defines the ORM mapping that Meadow uses for all CRUD operations:

- **Column definitions** with types, sizes, and defaults
- **JSON Schema** for request validation
- **Default identifier** (`IDTask`) and GUID identifier (`GUIDTask`)
- **Default object** template for new records

The server loads this schema and passes it to Meadow when creating the Task DAL instance. Meadow Endpoints then uses the same schema to auto-generate REST routes with proper type handling.

## Field Reference

| Field | Type | Description |
|-------|------|-------------|
| IDTask | AutoIdentity | Primary key (auto-increment) |
| GUIDTask | AutoGUID | UUID generated by Meadow on create |
| Name | String(200) | Task name |
| Description | Text | Task description (unlimited length) |
| DueDate | DateTime | When the task is due |
| LengthInHours | Decimal(10,2) | Estimated duration in hours |
| Status | String(32) | One of: Pending, In Progress, Complete |
| CreateDate | DateTime | Set automatically by Meadow on create |
| CreatingIDUser | Integer | Set automatically by Meadow on create |
| UpdateDate | DateTime | Set automatically by Meadow on update |
| UpdatingIDUser | Integer | Set automatically by Meadow on update |
| Deleted | Boolean | Soft-delete flag (Meadow never hard-deletes) |
| DeleteDate | DateTime | Set automatically by Meadow on delete |
| DeletingIDUser | Integer | Set automatically by Meadow on delete |

## Seed Data

The file `model/data/seeded_todo_events.csv` contains 1,000 realistic task records spanning four years of family life: personal errands, work tasks, birthdays, holidays, bills, vet appointments, and more.

On first server start, the `DatabaseInitializationService` checks whether the Task table is empty. If it is, it reads the CSV and creates each record through the Meadow DAL using `doCreate()`. Because the records pass through Meadow, every row gets a proper GUID, audit timestamps, and default values -- exactly as if a user had created them through the API.

To re-seed the database, delete `server/data/todo.sqlite` and restart the server.

## Files

| File | Purpose |
|------|---------|
| `Task.mddl` | Stricture MicroDDL source definition |
| `Task-Compiled.json` | Compiled DDL for SQLite table creation |
| `MeadowSchema-Task.json` | Meadow ORM schema (columns, types, defaults, JSON Schema) |
| `data/seeded_todo_events.csv` | 1,000 sample tasks for initial database population |
